<!DOCTYPE html>
<html lang="en">
  
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="generator" content="Typelevel Laika + Helium Theme" />
  <title>ADT (Algebraic Data Types)</title>
  
  <meta name="author" content="Travis Brown"/>
  
  <meta name="author" content="Zach McCoy"/>
  
  <meta name="author" content="Darren Gibson"/>
  
  <meta name="author" content="Erlend Hamnaberg"/>
  
  
  <meta name="description" content="Circe docs"/>
  
  
  
  <link rel="icon" sizes="32x32" type="image/png" href="../images/circe_light_no_border_146x173.png"/>
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700">
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:500">
  
  <link rel="stylesheet" type="text/css" href="../helium/site/icofont.min.css" />
    <link rel="stylesheet" type="text/css" href="../helium/site/laika-helium.css" />
  <script src="../helium/site/laika-helium.js"></script>
  
  
  <script> /* for avoiding page load transitions */ </script>
</head>

  <body>

    <header id="top-bar" class="light-default dark-default">

  <div class="row">
    <a id="nav-icon">
      <i class="icofont-laika navigationMenu" title="Navigation">&#xefa2;</i>
    </a>
    
    
  </div>

  <a class="image-link" href="https://github.com/circe/circe"><img src="../images/circe_light_no_border_146x173.png"></a>

  <div class="row links">
    
    <a class="icon-link svg-link" href="https://github.com/circe/circe"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
  </div>  

</header>
    
    <nav id="sidebar">

  <div class="row">
    
    <a class="icon-link svg-link" href="https://github.com/circe/circe"><span class="github" title="Source Code"><svg class="svg-icon" width="100%" height="100%" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
  <g class="svg-shape">
    <path d="M49.995,1c-27.609,-0 -49.995,22.386 -49.995,50.002c-0,22.09 14.325,40.83 34.194,47.444c2.501,0.458 3.413,-1.086 3.413,-2.412c0,-1.185 -0.043,-4.331 -0.067,-8.503c-13.908,3.021 -16.843,-6.704 -16.843,-6.704c-2.274,-5.773 -5.552,-7.311 -5.552,-7.311c-4.54,-3.103 0.344,-3.042 0.344,-3.042c5.018,0.356 7.658,5.154 7.658,5.154c4.46,7.64 11.704,5.433 14.552,4.156c0.454,-3.232 1.744,-5.436 3.174,-6.685c-11.102,-1.262 -22.775,-5.553 -22.775,-24.713c-0,-5.457 1.949,-9.92 5.147,-13.416c-0.516,-1.265 -2.231,-6.348 0.488,-13.233c0,0 4.199,-1.344 13.751,5.126c3.988,-1.108 8.266,-1.663 12.518,-1.682c4.245,0.019 8.523,0.574 12.517,1.682c9.546,-6.47 13.736,-5.126 13.736,-5.126c2.728,6.885 1.013,11.968 0.497,13.233c3.204,3.496 5.141,7.959 5.141,13.416c0,19.209 -11.691,23.436 -22.83,24.673c1.795,1.544 3.394,4.595 3.394,9.26c0,6.682 -0.061,12.076 -0.061,13.715c0,1.338 0.899,2.894 3.438,2.406c19.853,-6.627 34.166,-25.354 34.166,-47.438c-0,-27.616 -22.389,-50.002 -50.005,-50.002"/>
  </g>
</svg></span></a>
    
    <a class="icon-link glyph-link" href="https://discord.gg/XF3CXcMzqD"><i class="icofont-laika chat" title="Chat">&#xeed5;</i></a>
    
  </div>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="../quickstart.html">Quick Start</a></li>
    <li class="level1 nav-leaf"><a href="../parsing.html">Parsing JSON</a></li>
    <li class="level1 nav-leaf"><a href="../cursors.html">Traversing and modifying JSON</a></li>
    <li class="level1 nav-node"><a href="index.html">Encoding and Decoding</a></li>
    <li class="level2 nav-leaf"><a href="semiauto-derivation.html">Semi-automatic Derivation</a></li>
    <li class="level2 nav-leaf"><a href="auto-derivation.html">Automatic Derivation</a></li>
    <li class="level2 nav-leaf"><a href="custom-codecs.html">Custom Codecs</a></li>
    <li class="level2 active nav-leaf"><a href="#">ADT (Algebraic Data Types)</a></li>
    <li class="level2 nav-leaf"><a href="testing.html">Codec Testing</a></li>
    <li class="level2 nav-leaf"><a href="known-issues.html">Warnings and known issues</a></li>
    <li class="level2 nav-leaf"><a href="recursive-adt.html">Recursive ADT (Algebraic Data Types)</a></li>
    <li class="level1 nav-leaf"><a href="../optics.html">Optics</a></li>
    <li class="level1 nav-leaf"><a href="../performance.html">Performance</a></li>
    <li class="level1 nav-header">Related Projects</li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-fs2">circe-fs2</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-iteratee">circe-iteratee</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-generic-extras">circe-generic-extras</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-derivation">circe-derivation</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-optics">circe-optics</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-droste">circe-droste</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-spire">circe-spire</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-config">circe-config</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-yaml">circe-yaml</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-bson">circe-bson</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-schema">circe-schema</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-golden">circe-golden</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-json-schema">circe-json-schema</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-jackson">circe-jackson</a></li>
    <li class="level2 nav-leaf"><a href="https://github.com/circe/circe-argus">circe-argus</a></li>
  </ul>

</nav>

    <div id="container">

      
<nav id="page-nav">
  <p class="header"><a href="#">ADT (Algebraic Data Types)</a></p>

  <ul class="nav-list">
    <li class="level1 nav-leaf"><a href="#adts-encoding-and-decoding">ADTs encoding and decoding</a></li>
    <li class="level1 nav-leaf"><a href="#a-more-generic-solution">A more generic solution</a></li>
    <li class="level1 nav-leaf"><a href="#the-future">The future</a></li>
    <li class="level1 nav-leaf"><a href="#notes">Notes</a></li>
  </ul>

  <p class="footer"></p>
</nav>


      <main class="content">

        <h1 id="adt-algebraic-data-types" class="title">ADT (Algebraic Data Types)</h1>
        
        <h3 id="adts-encoding-and-decoding" class="section"><a class="anchor-link left" href="#adts-encoding-and-decoding"><i class="icofont-laika link">&#xef71;</i></a>ADTs encoding and decoding</h3>
        <p>The most straightforward way to encode / decode ADTs is by using generic derivation for the case classes but explicitly defined instances for the ADT type.</p>
        <p>Consider the following ADT:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">sealed</span><span> </span><span class="keyword">trait</span><span> </span><span class="type-name">Event</span><span>

</span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Foo</span><span>(</span><span class="identifier">i</span><span>: </span><span class="type-name">Int</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">Event</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Bar</span><span>(</span><span class="identifier">s</span><span>: </span><span class="type-name">String</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">Event</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Baz</span><span>(</span><span class="identifier">c</span><span>: </span><span class="type-name">Char</span><span>) </span><span class="keyword">extends</span><span> </span><span class="type-name">Event</span><span>
</span><span class="keyword">case</span><span> </span><span class="keyword">class</span><span> </span><span class="type-name">Qux</span><span>(</span><span class="identifier">values</span><span>: </span><span class="type-name">List</span><span>[</span><span class="type-name">String</span><span>]) </span><span class="keyword">extends</span><span> </span><span class="type-name">Event</span></code></pre>
        <p>And the encoder / decoder instances:</p>
        <pre><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">cats</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">functor</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.{ </span><span class="type-name">Decoder</span><span>, </span><span class="type-name">Encoder</span><span> }, </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">generic</span><span>.</span><span class="identifier">auto</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">_</span><span>

</span><span class="keyword">object</span><span> </span><span class="type-name">GenericDerivation</span><span> {
  </span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">encodeEvent</span><span>: </span><span class="type-name">Encoder</span><span>[</span><span class="type-name">Event</span><span>] = </span><span class="type-name">Encoder</span><span>.</span><span class="identifier">instance</span><span> {
    </span><span class="keyword">case</span><span> </span><span class="identifier">foo</span><span>: </span><span class="type-name">Foo</span><span> =&gt; </span><span class="identifier">foo</span><span>.</span><span class="identifier">asJson</span><span>
    </span><span class="keyword">case</span><span> </span><span class="identifier">bar</span><span>: </span><span class="type-name">Bar</span><span> =&gt; </span><span class="identifier">bar</span><span>.</span><span class="identifier">asJson</span><span>
    </span><span class="keyword">case</span><span> </span><span class="identifier">baz</span><span>: </span><span class="type-name">Baz</span><span> =&gt; </span><span class="identifier">baz</span><span>.</span><span class="identifier">asJson</span><span>
    </span><span class="keyword">case</span><span> </span><span class="identifier">qux</span><span>: </span><span class="type-name">Qux</span><span> =&gt; </span><span class="identifier">qux</span><span>.</span><span class="identifier">asJson</span><span>
  }

  </span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">decodeEvent</span><span>: </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Event</span><span>] =
    </span><span class="type-name">List</span><span>[</span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Event</span><span>]](
      </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Foo</span><span>].</span><span class="identifier">widen</span><span>,
      </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Bar</span><span>].</span><span class="identifier">widen</span><span>,
      </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Baz</span><span>].</span><span class="identifier">widen</span><span>,
      </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Qux</span><span>].</span><span class="identifier">widen</span><span>
    ).</span><span class="identifier">reduceLeft</span><span>(</span><span class="identifier">_</span><span> </span><span class="identifier">or</span><span> </span><span class="identifier">_</span><span>)
}</span></code></pre>
        <p>Note that we have to call <code>widen</code> (which is provided by Cats&#39;s <code>Functor</code> syntax, which we bring into scope with the first import) on the decoders because the <code>Decoder</code> type class is not covariant. The invariance of circe&#39;s type classes is a matter of <a href="https://twitter.com/Gentmen/status/829431567315513344">some controversy</a> (<code>Argonaut</code> for example has gone from invariant to covariant and back), but it has enough benefits that it&#39;s unlikely to change, which means we need workarounds like this occasionally.</p>
        <p>It&#39;s also worth noting that our explicit <code>Encoder</code> and <code>Decoder</code> instances will take precedence over the generically-derived instances we would otherwise get from the <code>io.circe.generic.auto._</code> import (see slides from Travis Brown&#39;s talk <a href="http://meta.plasm.us/slides/scalaworld/#1">here</a> for some discussion of how this prioritization works).</p>
        <p>We can use these instances like this:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="type-name">GenericDerivation</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">parser</span><span>.</span><span class="identifier">decode</span><span>

</span><span class="identifier">decode</span><span>[</span><span class="type-name">Event</span><span>](</span><span class="string-literal">&quot;&quot;&quot;{ &quot;i&quot;: 1000 }&quot;&quot;&quot;</span><span>)
</span><span class="comment">// res0: Either[io.circe.Error, Event] = Right(value = Foo(i = 1000))
</span><span>
(</span><span class="type-name">Foo</span><span>(</span><span class="number-literal">100</span><span>): </span><span class="type-name">Event</span><span>).</span><span class="identifier">asJson</span><span>.</span><span class="identifier">noSpaces</span><span>
</span><span class="comment">// res1: String = &quot;{\&quot;i\&quot;:100}&quot;</span></code></pre>
        <p>This works, and if you need to be able to specify the order that the ADT constructors are tried, it&#39;s currently the best solution. Having to enumerate the constructors like this is obviously not ideal, though, even if we get the case class instances for free.</p>
        <p>Finally, this approach has limitations for ADTs that are recursively defined. See the <a href="recursive-adt.html">Recursive ADT page</a> for more details.</p>
        
        <h3 id="a-more-generic-solution" class="section"><a class="anchor-link left" href="#a-more-generic-solution"><i class="icofont-laika link">&#xef71;</i></a>A more generic solution</h3>
        <p>We can avoid the fuss of writing out all the cases by using the <code>circe-shapes</code> module:</p>
        <pre><code class="nohighlight"><span class="comment">// To suppress previously imported implicit codecs.
</span><span class="keyword">import</span><span> </span><span class="type-name">GenericDerivation</span><span>.{ </span><span class="identifier">decodeEvent</span><span> =&gt; </span><span class="identifier">_</span><span>, </span><span class="identifier">encodeEvent</span><span> =&gt; </span><span class="identifier">_</span><span> }

</span><span class="keyword">object</span><span> </span><span class="type-name">ShapesDerivation</span><span> {
  </span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">shapes</span><span>
  </span><span class="keyword">import</span><span> </span><span class="identifier">shapeless</span><span>.{ </span><span class="type-name">Coproduct</span><span>, </span><span class="type-name">Generic</span><span> }

  </span><span class="keyword">implicit</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">encodeAdtNoDiscr</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">Repr</span><span> &lt;: </span><span class="type-name">Coproduct</span><span>](</span><span class="keyword">implicit</span><span>
    </span><span class="identifier">gen</span><span>: </span><span class="type-name">Generic</span><span>.</span><span class="type-name">Aux</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">Repr</span><span>],
    </span><span class="identifier">encodeRepr</span><span>: </span><span class="type-name">Encoder</span><span>[</span><span class="type-name">Repr</span><span>]
  ): </span><span class="type-name">Encoder</span><span>[</span><span class="type-name">A</span><span>] = </span><span class="identifier">encodeRepr</span><span>.</span><span class="identifier">contramap</span><span>(</span><span class="identifier">gen</span><span>.</span><span class="identifier">to</span><span>)

  </span><span class="keyword">implicit</span><span> </span><span class="keyword">def</span><span> </span><span class="declaration-name">decodeAdtNoDiscr</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">Repr</span><span> &lt;: </span><span class="type-name">Coproduct</span><span>](</span><span class="keyword">implicit</span><span>
    </span><span class="identifier">gen</span><span>: </span><span class="type-name">Generic</span><span>.</span><span class="type-name">Aux</span><span>[</span><span class="type-name">A</span><span>, </span><span class="type-name">Repr</span><span>],
    </span><span class="identifier">decodeRepr</span><span>: </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">Repr</span><span>]
  ): </span><span class="type-name">Decoder</span><span>[</span><span class="type-name">A</span><span>] = </span><span class="identifier">decodeRepr</span><span>.</span><span class="identifier">map</span><span>(</span><span class="identifier">gen</span><span>.</span><span class="identifier">from</span><span>)

}</span></code></pre>
        <p>And then:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="type-name">ShapesDerivation</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">parser</span><span>.</span><span class="identifier">decode</span><span>, </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">_</span><span>

</span><span class="identifier">decode</span><span>[</span><span class="type-name">Event</span><span>](</span><span class="string-literal">&quot;&quot;&quot;{ &quot;i&quot;: 1000 }&quot;&quot;&quot;</span><span>)
</span><span class="comment">// res2: Either[io.circe.Error, Event] = Right(value = Foo(i = 1000))
</span><span>
(</span><span class="type-name">Foo</span><span>(</span><span class="number-literal">100</span><span>): </span><span class="type-name">Event</span><span>).</span><span class="identifier">asJson</span><span>.</span><span class="identifier">noSpaces</span><span>
</span><span class="comment">// res3: String = &quot;{\&quot;i\&quot;:100}&quot;</span></code></pre>
        <p>This will work for any ADT anywhere that <code>encodeAdtNoDiscr</code> and <code>decodeAdtNoDiscr</code> are in scope. If we wanted it to be more limited, we could replace the generic <code>A</code> with our ADT types in those definitions, or we could make the definitions non-implicit and define implicit instances explicitly for the ADTs we want encoded this way.</p>
        <p>The main drawback of this approach (apart from the extra <code>circe-shapes</code> dependency) is that the constructors will be tried in alphabetical order, which may not be what we want if we have ambiguous case classes (where the member names and types are the same).</p>
        
        <h3 id="the-future" class="section"><a class="anchor-link left" href="#the-future"><i class="icofont-laika link">&#xef71;</i></a>The future</h3>
        <p>The <code>generic-extras</code> module provides a little more configurability in this respect. We can write the following, for example:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">generic</span><span>.</span><span class="identifier">extras</span><span>.</span><span class="identifier">auto</span><span>.</span><span class="identifier">_</span><span>
</span><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">generic</span><span>.</span><span class="identifier">extras</span><span>.</span><span class="type-name">Configuration</span><span>

</span><span class="keyword">implicit</span><span> </span><span class="keyword">val</span><span> </span><span class="identifier">genDevConfig</span><span>: </span><span class="type-name">Configuration</span><span> =
  </span><span class="type-name">Configuration</span><span>.</span><span class="keyword">default</span><span>.</span><span class="identifier">withDiscriminator</span><span>(</span><span class="string-literal">&quot;what_am_i&quot;</span><span>)</span></code></pre>
        <p>And then:</p>
        <pre class="keep-together pdf epub"><code class="nohighlight"><span class="keyword">import</span><span> </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">parser</span><span>.</span><span class="identifier">decode</span><span>, </span><span class="identifier">io</span><span>.</span><span class="identifier">circe</span><span>.</span><span class="identifier">syntax</span><span>.</span><span class="identifier">_</span><span>

(</span><span class="type-name">Foo</span><span>(</span><span class="number-literal">100</span><span>): </span><span class="type-name">Event</span><span>).</span><span class="identifier">asJson</span><span>.</span><span class="identifier">noSpaces</span><span>
</span><span class="comment">// res4: String = &quot;{\&quot;i\&quot;:100}&quot;
</span><span>
</span><span class="identifier">decode</span><span>[</span><span class="type-name">Event</span><span>](</span><span class="string-literal">&quot;&quot;&quot;{ &quot;i&quot;: 1000, &quot;what_am_i&quot;: &quot;Foo&quot; }&quot;&quot;&quot;</span><span>)
</span><span class="comment">// res5: Either[io.circe.Error, Event] = Right(value = Foo(i = 1000))</span></code></pre>
        <p>Instead of a wrapper object in the JSON we have an extra field that indicates the constructor. This isn&#39;t the default behavior since it has some weird corner cases (e.g. if one of our case classes had a member named <code>what_am_i</code>), but in many cases it&#39;s reasonable and it&#39;s been supported in <code>generic-extras</code> since that module was introduced.</p>
        
        <h3 id="notes" class="section"><a class="anchor-link left" href="#notes"><i class="icofont-laika link">&#xef71;</i></a>Notes</h3>
        <p>This still doesn&#39;t get us exactly what we want, but it&#39;s closer than the default behavior. It&#39;s also been considered to change <code>withDiscriminator</code> to take an <code>Option[String]</code> instead of a <code>String</code>, with <code>None</code> indicating that we don&#39;t want an extra field indicating the constructor, giving us the same behavior as our <code>circe-shape</code>s instances in the previous section, but haven&#39;t been implemented so far.</p>

        
<hr class="footer-rule"/>
<footer>
  Site generated by <a href="https://typelevel.org/Laika/">Laika</a> with the Helium theme.
</footer>


      </main>

    </div>

  </body>

</html>